/* .EditorTheme__code {
  background-color: transparent;
  font-family: Menlo, Consolas, Monaco, monospace;
  display: block;
  padding: 8px 8px 8px 52px;
  line-height: 1.53;
  font-size: 13px;
  margin: 0;
  margin-top: 8px;
  margin-bottom: 8px;
  overflow-x: auto;
  border: 1px solid #ccc;
  position: relative;
  border-radius: 8px;
  tab-size: 2;
}

.EditorTheme__code:before {
  content: attr(data-gutter);
  position: absolute;
  background-color: transparent;
  border-right: 1px solid #ccc;
  left: 0;
  top: 0;
  padding: 8px;
  color: #777;
  white-space: pre-wrap;
  text-align: right;
  min-width: 25px;
} */

.EditorTheme__table {
  border-collapse: collapse;
  border-spacing: 0;
  overflow-y: scroll;
  overflow-x: scroll;
  table-layout: fixed;
  width: fit-content;
  width: 100%;
  margin: 0px 25px 30px 0px;
}
/* 
.EditorTheme__tokenComment {
  color: slategray;
}

.EditorTheme__tokenPunctuation {
  color: #999;
}

.EditorTheme__tokenProperty {
  color: #905;
}

.EditorTheme__tokenSelector {
  color: #690;
}

.EditorTheme__tokenOperator {
  color: #9a6e3a;
}

.EditorTheme__tokenAttr {
  color: #07a;
}

.EditorTheme__tokenVariable {
  color: #e90;
}

.EditorTheme__tokenFunction {
  color: #dd4a68;
} */

.Collapsible__container {
  background-color: var(--background);
  border: 1px solid #ccc;
  border-radius: 0.5rem;
  margin-bottom: 0.5rem;
}

.Collapsible__title {
  padding: 0.25rem;
  padding-left: 1rem;
  position: relative;
  font-weight: bold;
  outline: none;
  cursor: pointer;
  list-style-type: disclosure-closed;
  list-style-position: inside;
}

.Collapsible__title p {
  display: inline-flex;
}

.Collapsible__title::marker {
  color: lightgray;
}

.Collapsible__container[open] > .Collapsible__title {
  list-style-type: disclosure-open;
}

/* Global overrides for all text elements within context blocks */
.context-block h1,
.context-block h2,
.context-block h3,
.context-block h4,
.context-block h5,
.context-block h6,
.context-block p,
.context-block blockquote {
  margin-top: 1rem !important;
}

/* Exclude header elements from the margin override */
.context-block .context-block-header-title {
  margin-top: 0 !important;
}

/* Remove bottom border from last row cells to prevent double border */
table.border-separate tr:last-child td,
table.border-separate tr:last-child th {
  border-bottom: 0;
}

.TableCellResizer__resizer {
  position: absolute;
  touch-action: none;
}

@media (pointer: coarse) {
  .TableCellResizer__resizer {
    background-color: #adf;
    mix-blend-mode: color;
  }
}

/* EMPTY PARAGRAPH HANDLING - RULE 2 (Rule 1 is in theme.ts)

   Goal: Make "table â†’ blank line â†’ heading" look identical to "table â†’ heading".

   Why not just hide the empty para with display:none like Rule 1?
   Because we WANT empty paras to remain visible between consecutive non-text-blocks
   (e.g., two code blocks) so users have a place to click and add content.

   So instead of hiding, we pull the following text element UP with negative margin
   to achieve the same visual spacing as if there were no blank line.

   THE MATH:
   - Empty para takes up: mt-2 (8px) + line-height (28px) = 36px total
   - Without blank line, heading would have mt-6 (24px) gap from the table
   - To match: we need the heading to end up 24px from the table
   - So: 36px (para space) + margin = 24px  â†’  margin = -12px = -0.75rem

   SELECTOR EXPLAINED:
   - :not(.text-block)                           â†’ previous element is code block, table, etc.
   - + .text-block:has(> br:only-child)          â†’ followed by empty paragraph
   - + .text-block:has([data-lexical-text])      â†’ followed by text content (heading, para, etc.)
*/
:not(.text-block)
  + .text-block:not(.focused-node):has(> br:only-child)
  + .text-block:has([data-lexical-text]) {
  margin-top: -0.75rem;
}

/* EMPTY PARAGRAPH COLLAPSE

   Rule 1: Paragraphs never focused - instant collapse (keep in DOM for indicator)
   Rule 2: Paragraphs user visited - animated collapse

   The first hidden paragraph shows a fold-vertical icon in the margin with a poof animation.
   Subsequent hidden paragraphs show no indicator (icon hidden via adjacent sibling selector).
*/

/* Rule 1: Collapse paragraphs never visited (keep in DOM for indicator) */
.text-block
  + .empty-para-collapsible:not(.focused-node):not(.was-focused-node):has(
    > br:only-child
  ) {
  height: 0;
  overflow: visible;
  margin: 0;
  padding: 0;
  position: relative;
}

/* Show icon on 2nd empty paragraph when there are 2+ consecutive.
   Requires 1st para to NOT be focused (so it's collapsing).
   Icon appears on 2nd para regardless of its focus state.
*/
.text-block:has([data-lexical-text])
  + .empty-para-collapsible:not(.focused-node):has(> br:only-child)
  + .empty-para-collapsible:has(> br:only-child) {
  position: relative;
}

.text-block:has([data-lexical-text])
  + .empty-para-collapsible:not(.focused-node):has(> br:only-child)
  + .empty-para-collapsible:has(> br:only-child)::before {
  content: "";
  position: absolute;
  left: -2rem;
  /* Vertically center icon within line-height (leading-7 = 28px, icon = 14px) */
  top: 0.375rem;
  width: 14px;
  height: 14px;
  background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23888888' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 22v-6'/%3E%3Cpath d='M12 8V2'/%3E%3Cpath d='M4 12H2'/%3E%3Cpath d='M10 12H8'/%3E%3Cpath d='M16 12h-2'/%3E%3Cpath d='M22 12h-2'/%3E%3Cpath d='m15 19-3-3-3 3'/%3E%3Cpath d='m15 5-3 3-3-3'/%3E%3C/svg%3E")
    center / contain no-repeat;
  animation: ghost-in 0.3s ease-out 0.3s backwards;
}

/* When 2nd para is also collapsed, offset icon down to account for lost mt-2 margin.
   Collapsed paras have margin-top: 0 (from animation), but visible paras have mt-2 (8px).
   Base is 0.375rem + 0.5rem margin offset = 0.875rem */
.text-block:has([data-lexical-text])
  + .empty-para-collapsible:not(.focused-node):has(> br:only-child)
  + .empty-para-collapsible:not(.focused-node):has(> br:only-child)::before {
  top: 0.875rem;
}

/* Poof on 2nd empty paragraph (only for user-created).
   Requires 1st para to have was-focused (user visited) and NOT be focused.
*/
.text-block:has([data-lexical-text])
  + .empty-para-collapsible.was-focused-node:not(.focused-node):has(
    > br:only-child
  )
  + .empty-para-collapsible:has(> br:only-child)::after {
  content: "ðŸ’¨";
  position: absolute;
  left: -2rem;
  top: 0.375rem;
  width: 14px;
  height: 14px;
  font-size: 10px;
  line-height: 14px;
  text-align: center;
  animation: poof-out 0.6s ease-out 0.25s forwards;
  pointer-events: none;
}

/* When 2nd para is also collapsed, offset poof down (same as icon) */
.text-block:has([data-lexical-text])
  + .empty-para-collapsible.was-focused-node:not(.focused-node):has(
    > br:only-child
  )
  + .empty-para-collapsible:not(.focused-node):has(> br:only-child)::after {
  top: 0.875rem;
}

/* Hide indicator on 3rd+ consecutive paragraphs */
.text-block:has([data-lexical-text])
  + .empty-para-collapsible:not(.focused-node):has(> br:only-child)
  + .empty-para-collapsible:has(> br:only-child)
  + .empty-para-collapsible:has(> br:only-child)::before {
  display: none;
}

.text-block:has([data-lexical-text])
  + .empty-para-collapsible:not(.focused-node):has(> br:only-child)
  + .empty-para-collapsible:has(> br:only-child)
  + .empty-para-collapsible:has(> br:only-child)::after {
  display: none;
}

@keyframes ghost-in {
  0% {
    opacity: 0;
    transform: scale(0.5);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes poof-out {
  0% {
    opacity: 1;
    transform: scale(1);
  }
  100% {
    opacity: 0;
    transform: scale(2);
  }
}

/* Rule 2: Animated collapse for paragraphs user visited (only after text-blocks) */
.text-block
  + .empty-para-collapsible.was-focused-node:not(.focused-node):has(
    > br:only-child
  ) {
  position: relative;
  animation: collapse 0.6s ease-out forwards;
}

@keyframes collapse {
  0% {
    max-height: 1.75rem;
    margin-top: 0;
    margin-bottom: 0;
  }
  100% {
    max-height: 0;
    margin-top: 0;
    margin-bottom: 0;
  }
}
